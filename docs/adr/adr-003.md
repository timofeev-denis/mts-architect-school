# ADR.003 Выбор шаблона интеграции 

* Статус: Предложено
* Владелец: denis.timоfeev@mts.ru

## Контекст
В рамках [ADR.002](adr-002.md) принято решение реализовывать отправку пользователям уведомлений по email из отдельного приложения `notificator`.
Необходимо выбрать шаблон интеграции основного приложения `conference` с приложением `notificator`.

## Варианты решения

### Вариант 1. REST
Команды на отправку уведомлений отправляются из `conference` в `notificator` по REST API. 
На стороне `conference` вызов REST API реализуется в несколько потоков, поскольку необходимо передавать большого количества команд на отправку уведомлений в приемлемые сроки.
На стороне `notificator` обеспечивается сохранение полученных команд до тех пор, пока соответствующее письмо не будет передано SMTP-серверу. 
На стороне `notificator` обеспечивается отправка писем SMTP-серверу в многопоточном режиме. 

### Вариант 2. Очередь сообщений
Команды на отправку уведомлений отправляются из `conference` в очередь (например - RabbitMQ) в виде сообщений.
`Notificator` получает сообщения в многопоточном режиме и в рамках обработки сообщения синхронно отправляет соответствующий email SMTP-серверу. 

### Сравнительная оценка
| Критерий                              | REST    | Очередь сообщений |
|:--------------------------------------|:--------|:------------------|
| *Отказоустойчивость*                  | 1       | 3                 |
| *Простота решения*                    | 1       | 3                 |
| *Скорость реализации*                 | 1       | 3                 |
| *Потребление вычислительных ресурсов* | 3       | 1                 |
| ***Оценка***                          | ***6*** | ***10***          |

## Решение
Мы используем интеграцию через очередь сообщений.

## Последствия
Нет.